<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Prague Explorer</title>
  <link
    rel="stylesheet"
    href="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.css"
  />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <button
    id="theme-toggle"
    class="theme-toggle"
    type="button"
    aria-pressed="false"
  >
    <span class="theme-toggle-track" aria-hidden="true">
      <span class="theme-toggle-thumb"></span>
    </span>
    <span class="theme-toggle-text">Dark mode</span>
  </button>
  <main class="app">
    <section id="welcome-screen" class="panel">
      <img src="../data/Prague_Civil_War_Live.png" alt="Prague Explorer logo" class="welcome-logo" />
      <form id="login-form" class="login-form" autocomplete="off">
        <label for="username-input">Choose your username</label>
        <div class="login-row">
          <input type="text" id="username-input" name="username" placeholder="e.g. PragueWalker" maxlength="32" required />
          <button type="button" id="login-button" class="primary">Enter Prague</button>
        </div>
      </form>
      <div id="known-players" class="known-players hidden">
        <h2>Jump back in</h2>
        <div id="known-players-list"></div>
      </div>
      <div class="actions">
        <button id="demo-button" class="secondary">Try Demo Mode</button>
      </div>
    </section>

    <section id="game-screen" class="panel hidden">
      <header class="top-bar">
        <div class="nav-group">
          <button id="back-button" class="secondary">Switch Player</button>
          <button id="find-me-button" class="primary">Find Me</button>
          <a id="leaderboard-button" class="secondary button-link" href="leaderboard.html">Leaderboard</a>
        </div>
        <div class="player-box">
        <div class="player-heading">
          <div class="player-identity">
            <h2 id="player-username">Username</h2>
            <button id="set-home-district-button" class="secondary small">Set Home</button>
          </div>
          <div class="player-actions">
            <button id="charge-attack-button" class="secondary small">Charge Attack</button>
            <button id="check-in-button" class="primary small">Check In</button>
          </div>
        </div>
        <div class="home-district-row">
          <span class="home-district-label">Home District:</span>
          <span id="home-district-value" class="home-district-value">Unset</span>
          <span id="home-presence-indicator" class="home-presence neutral">Unknown location</span>
        </div>
        <div id="dev-options" class="dev-options hidden">
          <label class="control checkbox">
            <input type="checkbox" id="dev-skip-cooldown" />
            <span>Skip cooldown</span>
          </label>
        </div>
        <div id="check-in-cooldown" class="check-in-cooldown hidden" aria-live="polite">
          <div class="cooldown-track">
            <div id="check-in-cooldown-fill" class="cooldown-fill"></div>
          </div>
          <span id="check-in-cooldown-label" class="cooldown-label"></span>
        </div>
        <div class="player-stats">
            <div class="stat">
              <span class="stat-label">Points</span>
              <span class="stat-value" id="player-points">0</span>
            </div>
            <div class="stat">
              <span class="stat-label">Check-ins</span>
              <span class="stat-value" id="player-checkins-count">0</span>
            </div>
            <div class="stat">
              <span class="stat-label">A/D Ratio</span>
              <span class="stat-value" id="player-ad-ratio">—</span>
            </div>
          </div>
        </div>
      </header>
      <div class="layout">
        <div id="map"></div>
        <aside class="sidebar">
          <section class="player-history">
            <div class="section-heading">
              <h2>Recent check-ins</h2>
              <button id="clear-history-button" class="secondary small">Clear</button>
            </div>
            <ul id="checkin-list" class="checkin-list"></ul>
          </section>
          <h2>Landmarks</h2>
          <ul id="poi-list"></ul>
          <h2>Activity</h2>
          <div id="status">Allow geolocation to begin.</div>
          <section class="layer-controls">
            <h2>Layers</h2>
            <label class="control slider">
              <span>Basemap</span>
              <div class="slider-row">
                <span class="slider-label">Sketch</span>
                <input type="range" id="basemap-slider" min="0" max="1" step="1" value="0" />
                <span class="slider-label">Normal</span>
              </div>
            </label>
            <label class="control checkbox">
              <input type="checkbox" id="districts-toggle" checked />
              <span>Show districts</span>
            </label>
            <label class="control checkbox">
              <input type="checkbox" id="parks-toggle" checked />
              <span>Show parks</span>
            </label>
            <label class="control checkbox">
              <input type="checkbox" id="urban-toggle" checked />
              <span>Show urban planning</span>
            </label>
            <label class="control checkbox">
              <input type="checkbox" id="cycling-toggle" />
              <span>Show cycling routes</span>
            </label>
          </section>
        </aside>
      </div>
    </section>
  </main>

  <div id="home-district-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="home-district-modal-title">
    <div id="home-district-modal-overlay" class="modal-overlay" tabindex="-1"></div>
    <div class="modal-content">
      <header class="modal-header">
        <h2 id="home-district-modal-title">Choose Home District</h2>
        <button type="button" id="home-district-modal-close" class="icon-button" aria-label="Close home district selector">
          &times;
        </button>
      </header>
      <div class="modal-body">
        <label for="home-district-search" class="sr-only">Search districts</label>
        <input type="search" id="home-district-search" class="modal-search" placeholder="Search districts…" autocomplete="off" />
        <div id="home-district-scroll" class="modal-scroll">
          <ul id="home-district-list" class="home-district-list" role="listbox" aria-labelledby="home-district-modal-title"></ul>
        </div>
      </div>
      <footer class="modal-footer">
        <button type="button" id="home-district-cancel" class="secondary">Cancel</button>
        <button type="button" id="home-district-confirm" class="primary" disabled>Set Home</button>
      </footer>
    </div>
  </div>

  <script src="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.js"></script>
  <script src="scripts/theme-toggle.js"></script>
  <script src="app.js"></script>
</body>
</html>
